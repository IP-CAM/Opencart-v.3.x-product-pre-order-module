{{ header }}{{ column_left }}
<div id="content">
    <div class="page-header">
        <div class="container-fluid">
            <div class="pull-right">
                <button type="submit" form="form" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
                <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a></div>
            <h1>{{ heading_title }}</h1>
            <ul class="breadcrumb">
                {% for breabcumb in breadcumbs %}
                    <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
                {% endfor %}
            </ul>
        </div>
    </div>
    <div class="container-fluid">
        {% if error_warning %}
            <div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
                <button type="button" class="close" data-dismiss="alert">&times;</button>
            </div>
        {% endif %}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-pencil"></i> {{ text_edit }}</h3>
            </div>
            <div class="panel-body">
                <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form" class="form-horizontal">
                    <ul class="nav nav-tabs">
                        <li class="active"><a href="#setting-tab" data-toggle="tab">{{ tab_setting }}</a></li>
                        <li><a href="#list-tab" data-toggle="tab">{{ tab_list }}</a></li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane active" id="setting-tab">
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-status">{{ entry_status }}</label>
                                <div class="col-sm-10">
                                    <select name="oct_product_preorder_data[status]" id="input-status" class="form-control">
                                        {% if oct_product_preorder_data.status %}
                                            <option value="1" selected="selected">{{ text_enabled }}</option>
                                            <option value="0">{{ text_disabled }}</option>
                                        {% else %}
                                            <option value="1">{{ text_enabled }}</option>
                                            <option value="0" selected="selected">{{ text_disabled }}</option>
                                        {% endif %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-status">{{ entry_notify_status }}</label>
                                <div class="col-sm-10">
                                    <select name="oct_product_preorder_data[notify_status]" id="input-notify_status" class="form-control">
                                        {% if oct_product_preorder_data.notify_status %}
                                            <option value="1" selected="selected">{{ text_enabled }}</option>
                                            <option value="0">{{ text_disabled }}</option>
                                        {% else %}
                                            <option value="1">{{ text_enabled }}</option>
                                            <option value="0" selected="selected">{{ text_disabled }}</option>
                                        {% endif %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-notify_email"><span data-toggle="tooltip" data-container="#setting-tab" title="{{ help_email }}">{{ entry_notify_email }}</span></label>
                                <div class="col-sm-10">
                                    <input type="text" name="oct_product_preorder_data[notify_email]" value="{{ oct_product_preorder_data.notify_email }}" id="input-notify_email" class="form-control" />
                                    {% if error_notify_email %}
                                        <div class="text-danger">{{ error_notify_email }}</div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-name">{{ entry_name }}</label>
                                <div class="col-sm-10">
                                    <select name="oct_product_preorder_data[name]" id="input-name" class="form-control">
                                        {% if oct_product_preorder_data.name == 1 %}
                                            <option value="1" selected="selected">{{ text_enabled }}</option>
                                            <option value="2">{{ text_enabled_required }}</option>
                                            <option value="0">{{ text_disabled }}</option>
                                        {% elseif oct_product_preorder_data.name == 2 %}
                                            <option value="1">{{ text_enabled }}</option>
                                            <option value="2" selected="selected">{{ text_enabled_required }}</option>
                                            <option value="0">{{ text_disabled }}</option>
                                        {% else %}
                                            <option value="1">{{ text_enabled }}</option>
                                            <option value="2">{{ text_enabled_required }}</option>
                                            <option value="0" selected="selected">{{ text_disabled }}</option>
                                        {% endif %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-telephone">{{ entry_telephone }}</label>
                                <div class="col-sm-10">
                                    <select name="oct_product_preorder_data[telephone]" id="input-telephone" class="form-control">
                                        {% if oct_product_preorder_data.telephone == 1 %}
                                            <option value="1" selected="selected">{{ text_enabled }}</option>
                                            <option value="2">{{ text_enabled_required }}</option>
                                            <option value="0">{{ text_disabled }}</option>
                                        {% elseif oct_product_preorder_data.telephone == 2 %}
                                            <option value="1">{{ text_enabled }}</option>
                                            <option value="2" selected="selected">{{ text_enabled_required }}</option>
                                            <option value="0">{{ text_disabled }}</option>
                                        {% else %}
                                            <option value="1">{{ text_enabled }}</option>
                                            <option value="2">{{ text_enabled_required }}</option>
                                            <option value="0" selected="selected">{{ text_disabled }}</option>
                                        {% endif %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-comment">{{ entry_comment }}</label>
                                <div class="col-sm-10">
                                    <select name="oct_product_preorder_data[comment]" id="input-comment" class="form-control">
                                        {% if oct_product_preorder_data.comment == 1 %}
                                            <option value="1" selected="selected">{{ text_enabled }}</option>
                                            <option value="2">{{ text_enabled_required }}</option>
                                            <option value="0">{{ text_disabled }}</option>
                                        {% elseif oct_product_preorder_data.comment == 2 %}
                                            <option value="1">{{ text_enabled }}</option>
                                            <option value="2" selected="selected">{{ text_enabled_required }}</option>
                                            <option value="0">{{ text_disabled }}</option>
                                        {% else %}
                                            <option value="1">{{ text_enabled }}</option>
                                            <option value="2">{{ text_enabled_required }}</option>
                                            <option value="0" selected="selected">{{ text_disabled }}</option>
                                        {% endif %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-email">{{ entry_email }}</label>
                                <div class="col-sm-10">
                                    <select name="oct_product_preorder_data[email]" id="input-email" class="form-control">
                                        {% if oct_product_preorder_data.email == 1 %}
                                            <option value="1" selected="selected">{{ text_enabled }}</option>
                                            <option value="2">{{ text_enabled_required }}</option>
                                            <option value="0">{{ text_disabled }}</option>
                                        {% elseif oct_product_preorder_data.email == 2 %}
                                            <option value="1">{{ text_enabled }}</option>
                                            <option value="2" selected="selected">{{ text_enabled_required }}</option>
                                            <option value="0">{{ text_disabled }}</option>
                                        {% else %}
                                            <option value="1">{{ text_enabled }}</option>
                                            <option value="2">{{ text_enabled_required }}</option>
                                            <option value="0" selected="selected">{{ text_disabled }}</option>
                                        {% endif %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-mask">{{ entry_mask }}</label>
                                <div class="col-sm-10">
                                    <input type="text" name="oct_product_preorder_data[mask]" value="{{ oct_product_preorder_data.mask }}" placeholder="{{ entry_mask_info }}" id="input-mask" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">{{ entry_stock_status }}</label>
                                <div class="col-sm-10">
                                    <div class="well well-sm" style="height: 150px; overflow: auto;">
                                        {% for stock_status in stock_statuses %}
                                            <div class="checkbox">
                                                <label>
                                                    <input
                                                            type="checkbox"
                                                            name="oct_product_preorder_data[stock_statuses][{{ stock_status.stock_status_id }}]"
                                                            value="{{ stock_status.stock_status_id }}" {% if oct_product_preorder_data['stock_statuses'][stock_status.stock_status_id] is not empty %}checked{% else %}{% endif %}
                                                    /> {{ stock_status.name }}
                                                </label>
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <div class="form-group required">
                                <label class="col-sm-2 control-label">{{ entry_call_button }}</label>
                                <div class="col-sm-10">
                                    <ul class="nav nav-tabs" id="call_button">
                                        {% for language in languages %}
                                            <li>
                                                <a href="#tab-call_button-language{{ language.language_id }}" data-toggle="tab"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /> {{ language.name }}</a>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                    <div class="tab-content">
                                        {% for language in languages %}
                                            <div class="tab-pane" id="tab-call_button-language{{ language.language_id }}">
                                                <input
                                                        type="text"
                                                        name="oct_product_preorder_text[{{ language.code }}][call_button]"
                                                        value="{% if oct_product_preorder_text[language.code].call_button is not empty %}{{ oct_product_preorder_text[language.code].call_button }}{% else %}{% endif %}"
                                                        class="form-control"
                                                />
                                                {% if error_call_button[language.code] %}
                                                    <div class="text-danger">{{ error_call_button[language.code] }}</div>
                                                {% endif %}
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <div class="form-group required">
                                <label class="col-sm-2 control-label">{{ entry_promo }}</label>
                                <div class="col-sm-10">
                                    <ul class="nav nav-tabs" id="promo">
                                        {% for language in languages %}
                                            <li>
                                                <a href="#tab-promo-language{{ language.language_id }}" data-toggle="tab"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /> {{ language.name }}</a>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                    <div class="tab-content">
                                        {% for language in languages %}
                                            <div class="tab-pane" id="tab-promo-language{{ language.language_id }}">
                                              <textarea
                                                      id="promo-language{{ language.language_id }}"
                                                      class="form-control summernote"
                                                      style="height:auto;resize:vertical;"
                                                      rows="3"
                                                      data-toggle="summernote"
                                                      data-lang="{{ summernote }}"
                                                      name="oct_product_preorder_text[{{ language.code }}][promo]">
                                                      {% if oct_product_preorder_text[language.code].promo is not empty %}{{ oct_product_preorder_text[language.code].promo }}{% else %}{% endif %}
                                              </textarea>
                                                {% if error_promo[language.code] %}
                                                    <div class="text-danger">{{ error_promo[language.code] }}</div>
                                                {% endif %}
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="list-tab">
                            <div id="history"></div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $('#call_button a:first').tab('show');
    $('#promo a:first').tab('show');

    $('#history').delegate('.pagination a', 'click', function(e) {
        e.preventDefault();
        $('#history').load(this.href);
    });
    $('#history').load('index.php?route=extension/module/oct_product_preorder/history&user_token={{ user_token }}');
    function delete_selected(request_id) {
        $.ajax({
            type: 'post',
            url:  'index.php?route=extension/module/oct_product_preorder/delete_selected&user_token={{ user_token }}&delete=' + request_id,
            dataType: 'json',
            success: function(json) {
                $('#history').load('index.php?route=extension/module/oct_product_preorder/history&user_token={{ user_token }}');
            }
        });
    }
    function delete_all() {
        $.ajax({
            type: 'get',
            url:  'index.php?route=extension/module/oct_product_preorder/delete_all&user_token={{ user_token }}',
            dataType: 'json',
            success: function(json) {
                $('#history').load('index.php?route=extension/module/oct_product_preorder/history&user_token={{ user_token }}');
            }
        });
    }
    function delete_all_selected() {
        $.ajax({
            type: 'post',
            url:  'index.php?route=extension/module/oct_product_preorder/delete_all_selected&user_token={{ user_token }}',
            data: $('#history input[type=\'checkbox\']:checked'),
            dataType: 'json',
            success: function(json) {
                $('#history').load('index.php?route=extension/module/oct_product_preorder/history&user_token={{ user_token }}');
            }
        });
    }
    function update_note(request_id, note) {
        $.ajax({
            type: 'post',
            url:  'index.php?route=extension/module/oct_product_preorder/update_note&user_token={{ user_token }}&request_id=' + request_id + '&note=' + note,
            dataType: 'json',
            success: function(json) {
                $('#history').load('index.php?route=extension/module/oct_product_preorder/history&user_token={{ user_token }}');
            }
        });
    }
</script>
{{ footer }}